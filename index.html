<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TradeQuest Journal</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.2/babel.min.js"></script>
<style>
  *{box-sizing:border-box;margin:0;padding:0;}
  body{background:#080c14;font-family:'Segoe UI',Arial,sans-serif;color:#e2e8f0;}
  ::-webkit-scrollbar{width:4px;} ::-webkit-scrollbar-track{background:#0a0e1a;} ::-webkit-scrollbar-thumb{background:#1e3050;border-radius:2px;}
</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const { useState, useEffect, useCallback } = React;

const DAILY_GOAL_PCT = 5;
const XP_PER_TRADE = 50;
const XP_PER_GOAL_HIT = 500;

const LEVELS = [
  { level: 1, title: "Paper Hands",       xpNeeded: 0,     color: "#888" },
  { level: 2, title: "Momentum Trader",   xpNeeded: 500,   color: "#60a5fa" },
  { level: 3, title: "Chart Reader",      xpNeeded: 1500,  color: "#34d399" },
  { level: 4, title: "Options Hawk",      xpNeeded: 3000,  color: "#a78bfa" },
  { level: 5, title: "Disciplined Sniper",xpNeeded: 6000,  color: "#fbbf24" },
  { level: 6, title: "Risk Manager",      xpNeeded: 10000, color: "#f97316" },
  { level: 7, title: "Compound King",     xpNeeded: 20000, color: "#ef4444" },
  { level: 8, title: "Market Wizard",     xpNeeded: 40000, color: "#ec4899" },
];

const ACHIEVEMENTS = [
  { id:"first_trade",    icon:"ðŸŽ¯", title:"First Blood",    desc:"Log your first trade",            xp:100  },
  { id:"first_green",    icon:"ðŸŒ±", title:"Green Day",      desc:"Finish a day in profit",          xp:200  },
  { id:"hit_goal",       icon:"âš¡", title:"5% Club",        desc:"Hit the 5% daily goal",           xp:500  },
  { id:"streak_3",       icon:"ðŸ”¥", title:"On Fire",        desc:"3-day green streak",              xp:300  },
  { id:"streak_5",       icon:"ðŸ’¥", title:"Unstoppable",    desc:"5-day green streak",              xp:750  },
  { id:"streak_10",      icon:"ðŸ‘‘", title:"The Streak",     desc:"10-day green streak",             xp:2000 },
  { id:"trades_10",      icon:"ðŸ“Š", title:"Grinder",        desc:"Log 10 trades",                   xp:200  },
  { id:"trades_50",      icon:"ðŸ§ ", title:"Experience",     desc:"Log 50 trades",                   xp:1000 },
  { id:"double_account", icon:"ðŸ’°", title:"2x Bag",         desc:"Double your starting balance",    xp:1500 },
  { id:"loss_bounce",    icon:"ðŸ’ª", title:"Resilient",      desc:"Green day after a red day",       xp:300  },
  { id:"discipline",     icon:"ðŸŽ“", title:"Disciplined",    desc:"Log a trade with a stop loss",    xp:150  },
  { id:"big_winner",     icon:"ðŸš€", title:"Moon Shot",      desc:"Single trade +100% return",       xp:500  },
  { id:"balance_500",    icon:"ðŸ’µ", title:"Stacking",       desc:"Account reaches $500",            xp:200  },
  { id:"balance_1000",   icon:"ðŸ’¸", title:"4 Digits",       desc:"Account reaches $1,000",          xp:500  },
  { id:"balance_5000",   icon:"ðŸ¦", title:"5 Grand",        desc:"Account reaches $5,000",          xp:1500 },
  { id:"balance_10000",  icon:"ðŸ†", title:"5-Figure Club",  desc:"Account reaches $10,000",         xp:3000 },
];

const MILESTONES = [100,250,500,1000,2000,5000,10000,25000,50000,100000];

const emptyForm = {
  date: new Date().toISOString().split("T")[0],
  ticker:"", type:"Call", entry:"", exit:"", contracts:"1", stopLoss:"", notes:""
};

const calcLevel = xp => { let c=LEVELS[0]; for(let l of LEVELS){if(xp>=l.xpNeeded)c=l;} return c; };
const calcNextLevel = xp => { for(let l of LEVELS){if(xp<l.xpNeeded)return l;} return null; };
const fmt = (n,d=2) => typeof n==="number" ? (n>=0?"+":"")+n.toFixed(d) : "â€”";
const fmtD = n => typeof n==="number" ? (n<0?"-$":"$")+Math.abs(n).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}) : "$0.00";
const groupByDate = trades => { const m={}; for(const t of trades){if(!m[t.date])m[t.date]=[];m[t.date].push(t);} return m; };
const dayPnl = ts => ts.reduce((s,t)=>s+(t.pnl||0),0);

// localStorage helpers
const lsGet = key => { try{ const v=localStorage.getItem(key); return v?JSON.parse(v):null; }catch(e){return null;} };
const lsSet = (key,val) => { try{ localStorage.setItem(key,JSON.stringify(val)); }catch(e){} };

export default function App() {
  const [tab, setTab]           = useState("dashboard");
  const [trades, setTrades]     = useState([]);
  const [account, setAccount]   = useState({balance:200,startBalance:200});
  const [xp, setXp]             = useState(0);
  const [achievements, setAch]  = useState([]);
  const [streak, setStreak]     = useState(0);
  const [longest, setLongest]   = useState(0);
  const [form, setForm]         = useState(emptyForm);
  const [toast, setToast]       = useState(null);
  const [newAch, setNewAch]     = useState(null);
  const [editBal, setEditBal]   = useState(false);
  const [balInput, setBalInput] = useState("");
  const [filterDate, setFilter] = useState("");

  useEffect(() => {
    const t  = lsGet("tq:trades");    if(t) setTrades(t);
    const a  = lsGet("tq:account");   if(a) setAccount(a);
    const x  = lsGet("tq:xp");        if(x!=null) setXp(x);
    const ac = lsGet("tq:ach");       if(ac) setAch(ac);
    const sk = lsGet("tq:streak");    if(sk){ setStreak(sk.c); setLongest(sk.l); }
  }, []);

  const showToast = (msg,type="success") => { setToast({msg,type}); setTimeout(()=>setToast(null),3000); };

  const unlock = useCallback((id, curAch, curXp) => {
    if(curAch.includes(id)) return {a:curAch,x:curXp};
    const ach = ACHIEVEMENTS.find(a=>a.id===id);
    if(!ach) return {a:curAch,x:curXp};
    const na=[...curAch,id];
    const nx=curXp+ach.xp;
    setNewAch(ach);
    setTimeout(()=>setNewAch(null),4000);
    return {a:na,x:nx};
  },[]);

  const handleAdd = () => {
    if(!form.ticker||!form.entry||!form.exit){ showToast("Fill ticker, entry, and exit.","error"); return; }
    const entry=parseFloat(form.entry), exit=parseFloat(form.exit), qty=parseInt(form.contracts)||1;
    const pnl=(exit-entry)*qty*100;
    const pct=((exit-entry)/entry)*100;
    const trade={id:Date.now(),date:form.date,ticker:form.ticker.toUpperCase(),type:form.type,
      entry,exit,contracts:qty,pnl,pct,stopLoss:form.stopLoss?parseFloat(form.stopLoss):null,
      notes:form.notes,outcome:pnl>=0?"W":"L"};

    const nt=[trade,...trades];
    const newBal=account.balance+pnl;
    const na2={...account,balance:newBal};
    let nx=xp+XP_PER_TRADE, na=[...achievements];

    const u=(id)=>{ const r=unlock(id,na,nx); na=r.a; nx=r.x; };
    if(!na.includes("first_trade")) u("first_trade");
    if(trade.stopLoss&&!na.includes("discipline")) u("discipline");
    if(pct>=100&&!na.includes("big_winner")) u("big_winner");
    if(nt.length>=10&&!na.includes("trades_10")) u("trades_10");
    if(nt.length>=50&&!na.includes("trades_50")) u("trades_50");
    if(newBal>=account.startBalance*2&&!na.includes("double_account")) u("double_account");
    for(const m of [500,1000,5000,10000]){ if(newBal>=m&&!na.includes(`balance_${m}`)) u(`balance_${m}`); }

    // streak calc
    const byDate=groupByDate(nt);
    const sorted=Object.keys(byDate).sort().reverse();
    let s=0, prevRed=false;
    for(const d of sorted){
      const dp=dayPnl(byDate[d]);
      if(dp>0){ s++; if(prevRed&&!na.includes("loss_bounce")) u("loss_bounce"); prevRed=false; }
      else { prevRed=true; break; }
    }
    if(s>0&&!na.includes("first_green")) u("first_green");
    if(s>=3&&!na.includes("streak_3")) u("streak_3");
    if(s>=5&&!na.includes("streak_5")) u("streak_5");
    if(s>=10&&!na.includes("streak_10")) u("streak_10");

    // daily goal check
    const todayTrades=nt.filter(t=>t.date===form.date);
    const todayTotal=todayTrades.reduce((s,t)=>s+t.pnl,0);
    const openBal=newBal-todayTotal;
    if(openBal>0&&(todayTotal/openBal)*100>=DAILY_GOAL_PCT&&!na.includes("hit_goal")){ u("hit_goal"); nx+=XP_PER_GOAL_HIT; }

    const nl=Math.max(s,longest);
    setTrades(nt); setAccount(na2); setXp(nx); setAch(na); setStreak(s); setLongest(nl);
    setForm({...emptyForm,date:form.date});
    lsSet("tq:trades",nt); lsSet("tq:account",na2); lsSet("tq:xp",nx); lsSet("tq:ach",na); lsSet("tq:streak",{c:s,l:nl});
    showToast(`Logged! ${pnl>=0?"+":""}${fmtD(pnl)} ${pnl>=0?"ðŸŸ¢":"ðŸ”´"}`);
  };

  const handleDelete = id => {
    const t=trades.find(t=>t.id===id); if(!t) return;
    const nt=trades.filter(t=>t.id!==id);
    const na2={...account,balance:account.balance-t.pnl};
    setTrades(nt); setAccount(na2);
    lsSet("tq:trades",nt); lsSet("tq:account",na2);
    showToast("Deleted.","info");
  };

  const handleSetBal = () => {
    const v=parseFloat(balInput);
    if(isNaN(v)||v<=0){ showToast("Enter a valid amount.","error"); return; }
    const a={balance:v,startBalance:v};
    setAccount(a); lsSet("tq:account",a); setEditBal(false); showToast("Balance set!");
  };

  const handleReset = () => {
    if(!window.confirm("Reset ALL data? Cannot be undone.")) return;
    setTrades([]); setAccount({balance:200,startBalance:200}); setXp(0); setAch([]); setStreak(0); setLongest(0);
    ["tq:trades","tq:account","tq:xp","tq:ach","tq:streak"].forEach(k=>localStorage.removeItem(k));
    showToast("Journal reset.","info");
  };

  // derived
  const level=calcLevel(xp), nextLvl=calcNextLevel(xp);
  const xpPct=nextLvl?((xp-level.xpNeeded)/(nextLvl.xpNeeded-level.xpNeeded))*100:100;
  const wins=trades.filter(t=>t.pnl>0), losses=trades.filter(t=>t.pnl<=0);
  const winRate=trades.length>0?(wins.length/trades.length)*100:0;
  const avgWin=wins.length>0?wins.reduce((s,t)=>s+t.pnl,0)/wins.length:0;
  const avgLoss=losses.length>0?losses.reduce((s,t)=>s+t.pnl,0)/losses.length:0;
  const totalPnl=account.balance-account.startBalance;
  const totalPct=account.startBalance>0?(totalPnl/account.startBalance)*100:0;
  const todayStr=new Date().toISOString().split("T")[0];
  const todayTs=trades.filter(t=>t.date===todayStr);
  const todayPnl=todayTs.reduce((s,t)=>s+t.pnl,0);
  const openBal=account.balance-todayPnl;
  const todayPct=openBal>0?(todayPnl/openBal)*100:0;
  const goalProg=Math.min((todayPct/DAILY_GOAL_PCT)*100,100);
  const goalTarget=openBal*(DAILY_GOAL_PCT/100);
  const nextMs=MILESTONES.find(m=>m>account.balance)||null;
  const prevMs=[...MILESTONES].reverse().find(m=>m<=account.balance)||account.startBalance;
  const msProg=nextMs?((account.balance-prevMs)/(nextMs-prevMs))*100:100;
  const displayTrades=filterDate?trades.filter(t=>t.date===filterDate):trades;

  const C = { // colors
    bg:"#080c14", card:"rgba(13,20,38,0.8)", border:"#1e2d45",
    green:"#00ffcc", red:"#ff4d4d", yellow:"#fbbf24", blue:"#60a5fa", purple:"#a78bfa"
  };

  const cardStyle = (extra={}) => ({
    background:C.card, border:`1px solid ${C.border}`, borderRadius:16, padding:20, ...extra
  });

  const inputStyle = {
    background:"#0d1426", border:`1px solid ${C.border}`, borderRadius:8,
    color:"#e2e8f0", padding:"10px 14px", fontSize:13, width:"100%",
    transition:"border-color 0.2s", outline:"none"
  };

  return (
    <div style={{background:C.bg,minHeight:"100vh",position:"relative",overflow:"hidden"}}>
      {/* grid bg */}
      <div style={{position:"fixed",inset:0,pointerEvents:"none",zIndex:0,
        backgroundImage:"linear-gradient(rgba(0,255,200,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(0,255,200,0.03) 1px,transparent 1px)",
        backgroundSize:"40px 40px"}}/>

      <style>{`
        @keyframes fadeIn{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}
        @keyframes bounceIn{from{opacity:0;transform:translateX(-50%) scale(0.7)}to{opacity:1;transform:translateX(-50%) scale(1)}}
        .tab{cursor:pointer;border:none;background:none;padding:9px 16px;font-size:13px;font-weight:600;border-radius:8px;transition:all 0.2s;letter-spacing:.3px;color:#888;}
        .tab:hover{background:rgba(0,255,200,0.08);color:#00ffcc;}
        .tab.on{background:rgba(0,255,200,0.12);color:#00ffcc;}
        .btn{background:linear-gradient(135deg,#00ffcc,#00c9a7);color:#080c14;border:none;border-radius:10px;padding:12px 28px;font-weight:800;font-size:14px;cursor:pointer;letter-spacing:.5px;transition:all .2s;}
        .btn:hover{transform:translateY(-1px);box-shadow:0 6px 20px rgba(0,255,200,.35);}
        .row:hover td{background:rgba(255,255,255,0.02);}
        input:focus,select:focus,textarea:focus{border-color:#00ffcc!important;box-shadow:0 0 0 2px rgba(0,255,200,.15)!important;}
      `}</style>

      {/* Toast */}
      {toast&&<div style={{position:"fixed",top:20,right:20,zIndex:1000,
        background:toast.type==="error"?"#3a0a0a":toast.type==="info"?"#0a1a2a":"#051a12",
        border:`1px solid ${toast.type==="error"?C.red:toast.type==="info"?C.blue:C.green}`,
        color:toast.type==="error"?C.red:toast.type==="info"?C.blue:C.green,
        borderRadius:10,padding:"12px 20px",fontSize:14,fontWeight:600,
        boxShadow:"0 8px 32px rgba(0,0,0,.5)",animation:"fadeIn .3s ease"}}>
        {toast.msg}
      </div>}

      {/* Achievement popup */}
      {newAch&&<div style={{position:"fixed",bottom:30,left:"50%",transform:"translateX(-50%)",zIndex:1000,
        background:"#0a1a2a",border:`2px solid ${C.yellow}`,borderRadius:16,padding:"16px 28px",
        textAlign:"center",boxShadow:`0 0 40px rgba(251,191,36,.3)`,animation:"bounceIn .5s ease",minWidth:260}}>
        <div style={{fontSize:36,marginBottom:6}}>{newAch.icon}</div>
        <div style={{color:C.yellow,fontWeight:800,fontSize:16}}>Achievement Unlocked!</div>
        <div style={{color:"#fff",fontWeight:700,fontSize:14,marginTop:2}}>{newAch.title}</div>
        <div style={{color:"#888",fontSize:12,marginTop:2}}>{newAch.desc}</div>
        <div style={{color:C.yellow,fontSize:12,marginTop:6,fontWeight:700}}>+{newAch.xp} XP</div>
      </div>}

      {/* Header */}
      <div style={{position:"sticky",top:0,zIndex:100,background:"rgba(8,12,20,.96)",
        backdropFilter:"blur(12px)",borderBottom:`1px solid ${C.border}`,padding:"0 20px"}}>
        <div style={{maxWidth:1100,margin:"0 auto",display:"flex",alignItems:"center",
          justifyContent:"space-between",height:60,flexWrap:"wrap",gap:8}}>
          <div style={{display:"flex",alignItems:"center",gap:10}}>
            <span style={{fontSize:22,letterSpacing:-1}}>
              <span style={{fontWeight:900,color:C.green}}>TRADE</span>
              <span style={{fontWeight:300,color:"#888"}}>QUEST</span>
            </span>
            <span style={{background:"rgba(0,255,200,.1)",border:"1px solid rgba(0,255,200,.3)",
              borderRadius:20,padding:"3px 12px",fontSize:11,color:C.green,fontWeight:700}}>
              LVL {level.level} â€¢ {level.title}
            </span>
          </div>
          <div style={{display:"flex",gap:2,flexWrap:"wrap"}}>
            {["dashboard","log","journal","achievements","milestones"].map(t=>(
              <button key={t} className={`tab ${tab===t?"on":""}`} onClick={()=>setTab(t)}>
                {t[0].toUpperCase()+t.slice(1)}
              </button>
            ))}
          </div>
          <div>
            <div style={{fontSize:11,color:"#555",letterSpacing:.5}}>BALANCE</div>
            <div style={{fontSize:16,fontWeight:800,color:account.balance>=account.startBalance?C.green:C.red}}>
              {fmtD(account.balance)}
            </div>
          </div>
        </div>
      </div>

      {/* XP bar */}
      <div style={{background:"rgba(0,0,0,.3)",borderBottom:"1px solid #0e1a2e",padding:"6px 20px"}}>
        <div style={{maxWidth:1100,margin:"0 auto",display:"flex",alignItems:"center",gap:12}}>
          <span style={{fontSize:11,color:"#555",minWidth:90,whiteSpace:"nowrap"}}>
            {xp.toLocaleString()} XP{nextLvl?` â†’ ${nextLvl.xpNeeded.toLocaleString()}`:" MAX"}
          </span>
          <div style={{flex:1,height:4,background:"#0e1a2e",borderRadius:2,overflow:"hidden"}}>
            <div style={{height:"100%",borderRadius:2,
              background:`linear-gradient(90deg,${level.color},${C.green})`,
              width:`${xpPct}%`,transition:"width .6s ease"}}/>
          </div>
          <span style={{fontSize:11,color:C.yellow,fontWeight:700,minWidth:90,textAlign:"right"}}>
            ðŸ”¥ {streak} day streak
          </span>
        </div>
      </div>

      {/* Page content */}
      <div style={{maxWidth:1100,margin:"0 auto",padding:"24px 20px",position:"relative",zIndex:1}}>

        {/* â”€â”€ DASHBOARD â”€â”€ */}
        {tab==="dashboard"&&<div>
          {/* Daily goal card */}
          <div style={{...cardStyle({marginBottom:20,border:"1px solid rgba(0,255,200,.2)",
            background:"linear-gradient(135deg,rgba(0,20,40,.9),rgba(0,10,25,.95))"}),position:"relative",overflow:"hidden"}}>
            <div style={{position:"absolute",top:0,right:0,width:200,height:200,
              background:"radial-gradient(circle,rgba(0,255,200,.06) 0%,transparent 70%)",borderRadius:"50%"}}/>
            <div style={{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:16}}>
              <div>
                <div style={{fontSize:12,color:"#555",letterSpacing:1,marginBottom:6}}>TODAY'S MISSION</div>
                <div style={{fontSize:28,fontWeight:900,color:todayPnl>=0?C.green:C.red,lineHeight:1}}>
                  {fmtD(todayPnl)}
                </div>
                <div style={{fontSize:13,color:"#666",marginTop:4}}>
                  {fmt(todayPct)}% of {DAILY_GOAL_PCT}% daily goal
                </div>
              </div>
              <div style={{textAlign:"right"}}>
                <div style={{fontSize:12,color:"#555",letterSpacing:1,marginBottom:4}}>TARGET</div>
                <div style={{fontSize:20,fontWeight:700,color:C.yellow}}>{fmtD(goalTarget)}</div>
                <div style={{fontSize:11,color:"#555",marginTop:2}}>= {DAILY_GOAL_PCT}% Ã— {fmtD(openBal)}</div>
              </div>
            </div>
            <div style={{marginTop:16}}>
              <div style={{display:"flex",justifyContent:"space-between",fontSize:11,color:"#555",marginBottom:6}}>
                <span>Daily goal progress</span>
                <span style={{color:goalProg>=100?C.green:C.yellow,fontWeight:700}}>
                  {goalProg>=100?"âœ… GOAL HIT!":goalProg.toFixed(0)+"%"}
                </span>
              </div>
              <div style={{height:10,background:"#0a1020",borderRadius:5,overflow:"hidden"}}>
                <div style={{height:"100%",borderRadius:5,transition:"width .8s ease",
                  background:goalProg>=100?"linear-gradient(90deg,#00ffcc,#00ff88)":"linear-gradient(90deg,#fbbf24,#f97316)",
                  width:`${Math.min(goalProg,100)}%`,
                  boxShadow:goalProg>=100?"0 0 12px rgba(0,255,200,.5)":"0 0 8px rgba(251,191,36,.4)"}}/>
              </div>
            </div>
          </div>

          {/* Stats */}
          <div style={{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(155px,1fr))",gap:12,marginBottom:20}}>
            {[
              {label:"TOTAL GAIN",  value:fmtD(totalPnl),        sub:fmt(totalPct)+"%",    color:totalPnl>=0?C.green:C.red},
              {label:"WIN RATE",    value:winRate.toFixed(1)+"%", sub:`${wins.length}W / ${losses.length}L`, color:winRate>=50?C.green:winRate>=35?C.yellow:C.red},
              {label:"AVG WIN",     value:fmtD(avgWin),           sub:"per trade",          color:C.green},
              {label:"AVG LOSS",    value:fmtD(avgLoss),          sub:"per trade",          color:C.red},
              {label:"STREAK",      value:streak,                  sub:`best: ${longest}`,  color:streak>=3?C.yellow:C.blue},
              {label:"TOTAL TRADES",value:trades.length,           sub:"logged",            color:C.purple},
            ].map((s,i)=>(
              <div key={i} style={{...cardStyle(),textAlign:"center"}}>
                <div style={{fontSize:10,color:"#555",letterSpacing:1,marginBottom:6}}>{s.label}</div>
                <div style={{fontSize:22,fontWeight:800,color:s.color}}>{s.value}</div>
                <div style={{fontSize:11,color:"#444",marginTop:3}}>{s.sub}</div>
              </div>
            ))}
          </div>

          {/* Compound projector */}
          <div style={cardStyle({marginBottom:20})}>
            <div style={{fontSize:12,color:"#555",letterSpacing:1,marginBottom:16}}>ðŸ“ˆ COMPOUND GROWTH PROJECTOR (5%/day)</div>
            <div style={{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(115px,1fr))",gap:10}}>
              {[1,5,10,20,30,60].map(d=>{
                const proj=account.balance*Math.pow(1.05,d);
                return <div key={d} style={{textAlign:"center",background:"#0a1020",borderRadius:10,padding:"12px 8px"}}>
                  <div style={{fontSize:10,color:"#555",marginBottom:4}}>{d} {d===1?"day":"days"}</div>
                  <div style={{fontSize:15,fontWeight:700,color:C.green}}>{fmtD(proj)}</div>
                </div>;
              })}
            </div>
            <div style={{marginTop:12,fontSize:11,color:"#444",textAlign:"center"}}>
              At 5%/day from {fmtD(account.balance)} â†’ <strong style={{color:C.yellow}}>{fmtD(account.balance*Math.pow(1.05,30))}</strong> in 30 days (+{((Math.pow(1.05,30)-1)*100).toFixed(0)}%)
            </div>
          </div>

          {/* Set balance */}
          <div style={cardStyle({marginBottom:20,display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:12})}>
            <div>
              <div style={{fontSize:11,color:"#555",letterSpacing:.5}}>Starting Balance</div>
              <div style={{fontSize:18,fontWeight:700,color:"#888"}}>{fmtD(account.startBalance)}</div>
            </div>
            {editBal
              ? <div style={{display:"flex",gap:8,alignItems:"center"}}>
                  <input style={{...inputStyle,width:140}} type="number" placeholder="New balance"
                    value={balInput} onChange={e=>setBalInput(e.target.value)}/>
                  <button className="btn" style={{padding:"10px 16px",fontSize:13}} onClick={handleSetBal}>Set</button>
                  <button onClick={()=>setEditBal(false)} style={{background:"none",border:`1px solid ${C.border}`,
                    borderRadius:8,color:"#888",padding:"10px 14px",cursor:"pointer",fontSize:13}}>Cancel</button>
                </div>
              : <button onClick={()=>{setEditBal(true);setBalInput(account.startBalance);}}
                  style={{background:"none",border:`1px solid ${C.border}`,borderRadius:8,
                    color:C.blue,padding:"8px 16px",cursor:"pointer",fontSize:13}}>
                  Set Starting Balance
                </button>
            }
          </div>

          <div style={{textAlign:"right"}}>
            <button onClick={handleReset} style={{background:"none",border:"1px solid #3a1a1a",
              borderRadius:8,color:"#555",padding:"8px 16px",cursor:"pointer",fontSize:12}}>
              Reset Journal
            </button>
          </div>
        </div>}

        {/* â”€â”€ LOG â”€â”€ */}
        {tab==="log"&&<div>
          <div style={{marginBottom:24}}>
            <h2 style={{fontSize:20,fontWeight:800,color:"#fff",marginBottom:4}}>Log a Trade</h2>
            <p style={{color:"#555",fontSize:13}}>Record every trade â€” discipline compounds as much as capital.</p>
          </div>
          <div style={cardStyle({maxWidth:640})}>
            <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14}}>
              {[
                {label:"DATE",         key:"date",      type:"date",   placeholder:""},
                {label:"TICKER",       key:"ticker",    type:"text",   placeholder:"e.g. IWM 265C"},
                null, // type select
                {label:"CONTRACTS",    key:"contracts", type:"number", placeholder:"1"},
                {label:"ENTRY PRICE",  key:"entry",     type:"number", placeholder:"0.00"},
                {label:"EXIT PRICE",   key:"exit",      type:"number", placeholder:"0.00"},
                {label:"STOP LOSS  +150 XP", key:"stopLoss", type:"number", placeholder:"Optional but earns XP"},
              ].map((f,i)=>{
                if(f===null) return (
                  <div key="type">
                    <div style={{fontSize:11,color:"#555",letterSpacing:.5,display:"block",marginBottom:6}}>TYPE</div>
                    <select style={inputStyle} value={form.type} onChange={e=>setForm({...form,type:e.target.value})}>
                      {["Call","Put","Stock","SPXW Call","SPXW Put","Other"].map(t=><option key={t}>{t}</option>)}
                    </select>
                  </div>
                );
                return <div key={f.key}>
                  <label style={{fontSize:11,color:"#555",letterSpacing:.5,display:"block",marginBottom:6}}>{f.label}</label>
                  <input style={inputStyle} type={f.type} step={f.type==="number"?"0.01":undefined}
                    placeholder={f.placeholder} value={form[f.key]}
                    onChange={e=>setForm({...form,[f.key]:e.target.value})}/>
                </div>;
              })}
              <div style={{gridColumn:"1 / -1"}}>
                <label style={{fontSize:11,color:"#555",letterSpacing:.5,display:"block",marginBottom:6}}>NOTES / THESIS</label>
                <textarea style={{...inputStyle,resize:"vertical"}} rows={3}
                  placeholder="Why did you take this trade? What was your setup?"
                  value={form.notes} onChange={e=>setForm({...form,notes:e.target.value})}/>
              </div>
            </div>

            {form.entry&&form.exit&&form.contracts&&(()=>{
              const p=(parseFloat(form.exit)-parseFloat(form.entry))*parseInt(form.contracts||1)*100;
              const green=p>=0;
              return <div style={{margin:"16px 0",padding:"12px 16px",borderRadius:10,
                background:green?"rgba(0,255,200,.07)":"rgba(255,77,77,.07)",
                border:`1px solid ${green?"rgba(0,255,200,.2)":"rgba(255,77,77,.2)"}`,
                display:"flex",justifyContent:"space-between",alignItems:"center"}}>
                <div style={{fontSize:12,color:"#666"}}>Estimated P&amp;L</div>
                <div style={{fontSize:18,fontWeight:800,color:green?C.green:C.red}}>{fmtD(p)}</div>
              </div>;
            })()}

            <button className="btn" onClick={handleAdd} style={{width:"100%",marginTop:4,fontSize:15,padding:14}}>
              Log Trade &nbsp;+{XP_PER_TRADE} XP
            </button>
          </div>
        </div>}

        {/* â”€â”€ JOURNAL â”€â”€ */}
        {tab==="journal"&&<div>
          <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20,flexWrap:"wrap",gap:12}}>
            <div>
              <h2 style={{fontSize:20,fontWeight:800,color:"#fff"}}>Trade Journal</h2>
              <p style={{color:"#555",fontSize:13}}>{trades.length} trades logged</p>
            </div>
            <input style={{...inputStyle,width:160}} type="date" value={filterDate}
              onChange={e=>setFilter(e.target.value)} title="Filter by date"/>
          </div>
          {displayTrades.length===0
            ? <div style={cardStyle({textAlign:"center",padding:48,color:"#444"})}>
                No trades yet. Go to <strong style={{color:C.green}}>Log</strong> to add your first trade.
              </div>
            : <div style={{...cardStyle({padding:0}),overflow:"hidden"}}>
                <div style={{overflowX:"auto"}}>
                  <table style={{width:"100%",borderCollapse:"collapse",fontSize:13}}>
                    <thead>
                      <tr style={{borderBottom:`1px solid ${C.border}`}}>
                        {["Date","Ticker","Type","Qty","Entry","Exit","P&L","Return","Notes",""].map(h=>(
                          <th key={h} style={{padding:"12px 16px",textAlign:"left",color:"#555",
                            fontWeight:600,fontSize:11,letterSpacing:.5,whiteSpace:"nowrap"}}>{h}</th>
                        ))}
                      </tr>
                    </thead>
                    <tbody>
                      {displayTrades.map(t=>(
                        <tr key={t.id} className="row" style={{borderBottom:"1px solid #0e1a2e"}}>
                          <td style={{padding:"11px 16px",color:"#888",whiteSpace:"nowrap"}}>{t.date}</td>
                          <td style={{padding:"11px 16px",fontWeight:700,color:"#fff"}}>{t.ticker}</td>
                          <td style={{padding:"11px 16px",color:C.blue,fontSize:12}}>{t.type}</td>
                          <td style={{padding:"11px 16px",color:"#888"}}>{t.contracts}</td>
                          <td style={{padding:"11px 16px",color:"#aaa"}}>${t.entry.toFixed(2)}</td>
                          <td style={{padding:"11px 16px",color:"#aaa"}}>${t.exit.toFixed(2)}</td>
                          <td style={{padding:"11px 16px",fontWeight:700,color:t.pnl>=0?C.green:C.red,whiteSpace:"nowrap"}}>
                            {fmtD(t.pnl)}
                          </td>
                          <td style={{padding:"11px 16px",color:t.pct>=0?C.green:C.red,fontSize:12}}>
                            {fmt(t.pct,1)}%
                          </td>
                          <td style={{padding:"11px 16px",color:"#555",fontSize:12,
                            maxWidth:160,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}>
                            {t.notes||"â€”"}
                          </td>
                          <td style={{padding:"11px 16px"}}>
                            <button onClick={()=>handleDelete(t.id)} style={{background:"none",border:"none",
                              color:"#3a1a1a",cursor:"pointer",fontSize:16,transition:"color .2s"}}
                              onMouseOver={e=>e.target.style.color=C.red}
                              onMouseOut={e=>e.target.style.color="#3a1a1a"}>âœ•</button>
                          </td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>
              </div>
          }
        </div>}

        {/* â”€â”€ ACHIEVEMENTS â”€â”€ */}
        {tab==="achievements"&&<div>
          <div style={{marginBottom:20}}>
            <h2 style={{fontSize:20,fontWeight:800,color:"#fff"}}>Achievements</h2>
            <p style={{color:"#555",fontSize:13}}>{achievements.length} / {ACHIEVEMENTS.length} unlocked â€¢ {xp.toLocaleString()} total XP</p>
          </div>
          {/* Level card */}
          <div style={{...cardStyle({marginBottom:20}),border:`1px solid ${level.color}44`}}>
            <div style={{display:"flex",alignItems:"center",gap:20,flexWrap:"wrap"}}>
              <div style={{width:64,height:64,borderRadius:"50%",flexShrink:0,
                background:`radial-gradient(circle,${level.color}33,${level.color}11)`,
                border:`2px solid ${level.color}`,display:"flex",alignItems:"center",
                justifyContent:"center",fontSize:26,fontWeight:900,color:level.color}}>
                {level.level}
              </div>
              <div style={{flex:1}}>
                <div style={{fontSize:11,color:"#555",letterSpacing:1}}>CURRENT RANK</div>
                <div style={{fontSize:22,fontWeight:900,color:level.color}}>{level.title}</div>
                <div style={{marginTop:8,height:6,background:"#0a1020",borderRadius:3,overflow:"hidden"}}>
                  <div style={{height:"100%",borderRadius:3,
                    background:`linear-gradient(90deg,${level.color},${C.green})`,
                    width:`${xpPct}%`,transition:"width .8s ease"}}/>
                </div>
                <div style={{display:"flex",justifyContent:"space-between",marginTop:4,fontSize:11,color:"#444"}}>
                  <span>{xp.toLocaleString()} XP</span>
                  <span>{nextLvl?`${nextLvl.xpNeeded.toLocaleString()} XP to ${nextLvl.title}`:"MAX LEVEL"}</span>
                </div>
              </div>
            </div>
          </div>
          <div style={{display:"grid",gridTemplateColumns:"repeat(auto-fill,minmax(240px,1fr))",gap:12}}>
            {ACHIEVEMENTS.map(ach=>{
              const unlocked=achievements.includes(ach.id);
              return <div key={ach.id} style={{...cardStyle(),opacity:unlocked?1:.45,
                border:unlocked?"1px solid rgba(251,191,36,.3)":`1px solid ${C.border}`,
                background:unlocked?"rgba(20,16,5,.9)":C.card,transition:"all .2s"}}>
                <div style={{display:"flex",gap:12,alignItems:"flex-start"}}>
                  <div style={{fontSize:28,flexShrink:0,filter:unlocked?"none":"grayscale(1)"}}>{ach.icon}</div>
                  <div>
                    <div style={{fontWeight:700,color:unlocked?C.yellow:"#666",fontSize:14}}>{ach.title}</div>
                    <div style={{color:"#555",fontSize:12,marginTop:2}}>{ach.desc}</div>
                    <div style={{color:C.yellow,fontSize:11,marginTop:5,fontWeight:700}}>
                      {unlocked?`âœ“ Earned +${ach.xp} XP`:`+${ach.xp} XP`}
                    </div>
                  </div>
                </div>
              </div>;
            })}
          </div>
        </div>}

        {/* â”€â”€ MILESTONES â”€â”€ */}
        {tab==="milestones"&&<div>
          <div style={{marginBottom:20}}>
            <h2 style={{fontSize:20,fontWeight:800,color:"#fff"}}>Account Milestones</h2>
            <p style={{color:"#555",fontSize:13}}>Your journey from {fmtD(account.startBalance)} â†’ financial freedom</p>
          </div>
          {nextMs&&<div style={{...cardStyle({marginBottom:20}),border:"1px solid rgba(0,255,200,.2)",background:"rgba(0,10,20,.9)"}}>
            <div style={{fontSize:11,color:"#555",letterSpacing:1,marginBottom:8}}>NEXT MILESTONE</div>
            <div style={{display:"flex",justifyContent:"space-between",alignItems:"flex-end",marginBottom:12,flexWrap:"wrap",gap:8}}>
              <div>
                <div style={{fontSize:32,fontWeight:900,color:C.green}}>{fmtD(nextMs)}</div>
                <div style={{color:"#555",fontSize:13}}>Need {fmtD(nextMs-account.balance)} more</div>
              </div>
              <div style={{textAlign:"right"}}>
                <div style={{color:"#888",fontSize:12}}>At 5%/day from now</div>
                <div style={{color:C.yellow,fontWeight:700,fontSize:15}}>
                  ~{Math.ceil(Math.log(nextMs/account.balance)/Math.log(1.05))} trading days
                </div>
              </div>
            </div>
            <div style={{height:10,background:"#0a1020",borderRadius:5,overflow:"hidden"}}>
              <div style={{height:"100%",borderRadius:5,
                background:"linear-gradient(90deg,#00ffcc,#00ff88)",
                width:`${msProg}%`,transition:"width .8s ease",
                boxShadow:"0 0 10px rgba(0,255,200,.4)"}}/>
            </div>
            <div style={{display:"flex",justifyContent:"space-between",marginTop:4,fontSize:11,color:"#444"}}>
              <span>{fmtD(prevMs)}</span>
              <span>{msProg.toFixed(1)}% there</span>
              <span>{fmtD(nextMs)}</span>
            </div>
          </div>}

          <div style={{display:"flex",flexDirection:"column",gap:10}}>
            {MILESTONES.map((m,i)=>{
              const reached=account.balance>=m;
              const isCur=!reached&&(i===0||account.balance>=MILESTONES[i-1]);
              return <div key={m} style={{...cardStyle({display:"flex",alignItems:"center",gap:16,padding:"16px 20px"}),
                border:reached?"1px solid rgba(0,255,200,.3)":isCur?"1px solid rgba(251,191,36,.3)":`1px solid ${C.border}`,
                background:reached?"rgba(0,20,14,.8)":isCur?"rgba(20,16,0,.8)":"rgba(13,20,38,.5)",
                opacity:reached||isCur?1:.55}}>
                <div style={{width:40,height:40,borderRadius:"50%",flexShrink:0,
                  display:"flex",alignItems:"center",justifyContent:"center",
                  fontSize:18,fontWeight:900,
                  background:reached?"rgba(0,255,200,.15)":isCur?"rgba(251,191,36,.1)":"#0a1020",
                  border:`2px solid ${reached?C.green:isCur?C.yellow:C.border}`,
                  color:reached?C.green:isCur?C.yellow:"#444"}}>
                  {reached?"âœ“":isCur?"â†’":"â—‹"}
                </div>
                <div style={{flex:1}}>
                  <div style={{fontWeight:700,color:reached?C.green:isCur?C.yellow:"#666",fontSize:16}}>{fmtD(m)}</div>
                  {isCur&&<div style={{fontSize:12,color:"#555",marginTop:2}}>
                    {fmtD(m-account.balance)} remaining â€¢ ~{Math.ceil(Math.log(m/account.balance)/Math.log(1.05))} days at 5%/day
                  </div>}
                </div>
                <div style={{fontSize:22}}>{reached?"ðŸ’°":isCur?"ðŸŽ¯":"ðŸ”’"}</div>
              </div>;
            })}
          </div>

          <div style={cardStyle({marginTop:20,textAlign:"center",padding:28})}>
            <div style={{fontSize:28,marginBottom:8}}>ðŸ“Š</div>
            <div style={{fontSize:14,color:"#888",lineHeight:1.8}}>
              Starting at {fmtD(account.startBalance)}, compounding at{" "}
              <strong style={{color:C.green}}>5% per day</strong> gets you to<br/>
              <strong style={{color:C.yellow,fontSize:18}}>{fmtD(account.startBalance*Math.pow(1.05,20))}</strong> in 20 days and{" "}
              <strong style={{color:C.green,fontSize:18}}>{fmtD(account.startBalance*Math.pow(1.05,60))}</strong> in 60 days.
            </div>
            <div style={{marginTop:12,fontSize:12,color:"#444"}}>The math is real. The discipline is the variable.</div>
          </div>
        </div>}

      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
</script>
</body>
</html>
